<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Retro Terminal Interface</title>
  <style>
    body {
      background-color: #2b2b2b;
      color: #b2b2b2;
      font-family: 'Courier New', Courier, monospace;
    }
    #terminal, #form {
      display: none;
    }
    #terminal.visible, #form.visible {
      display: block;
    }
    .hidden {
      display: none;
    }
    #terminal {
      border: 2px solid #00ff00;
      padding: 10px;
      margin: 20px;
    }
    #form {
      margin: 20px;
    }
    input, button {
      background-color: #2b2b2b;
      color: #00ff00;
      border: 1px solid #00ff00;
      padding: 5px;
      margin: 5px 0;
      width: 100%;
    }
  </style>
</head>
<body>
  <div id="terminal" class="visible">
    <pre id="terminal-output">
Welcome to the Retro Terminal
    </pre>
    <input type="text" id="terminal-input" placeholder="Type a command...">
  </div>
  <div id="form" class="hidden">
    <h2>Dispatch Workflow</h2>
    <form id="workflow-form">
      <label for="repo">Repository:</label>
      <input type="text" id="repo" name="repo" required><br>
      <label for="owner">Owner:</label>
      <input type="text" id="owner" name="owner" required><br>
      <label for="branch">Branch:</label>
      <input type="text" id="branch" name="branch" required><br>
      <label for="commit">Commit:</label>
      <input type="text" id="commit" name="commit" required><br>
      <button type="submit">Dispatch</button>
    </form>
  </div>
  <script>
    const terminal = document.getElementById('terminal');
    const form = document.getElementById('form');
    const terminalInput = document.getElementById('terminal-input');
    const terminalOutput = document.getElementById('terminal-output');
    const workflowForm = document.getElementById('workflow-form');

    document.addEventListener('keydown', (event) => {
      if (event.key === 'Escape') {
        terminal.classList.toggle('hidden');
        form.classList.toggle('hidden');
      }
    });

    terminalInput.addEventListener('keydown', (event) => {
      if (event.key === 'Enter') {
        const command = terminalInput.value;
        terminalOutput.textContent += `\n$ ${command}`;
        terminalInput.value = '';

        // Send command to manage.js
        fetch('/execute-command', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ command })
        }).then(response => response.json())
          .then(data => {
            terminalOutput.textContent += `\n${data.output}`;
          });
      }
    });

    workflowForm.addEventListener('submit', (event) => {
      event.preventDefault();
      const data = {
        repo: document.getElementById('repo').value,
        owner: document.getElementById('owner').value,
        branch: document.getElementById('branch').value,
        commit: document.getElementById('commit').value
      };
      console.log('Dispatching workflow with data:', data);
      // Implement workflow dispatch logic here
    });
  </script>
</body>
</html>
